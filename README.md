My NixOS configuration, it's not beautiful nor complete but does the trick for the most part.
